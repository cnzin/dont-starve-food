(function(){var K,Y,ja=30,r=16*ja,ja=r/16,Z=3*r,k=6*r,l=10*r,q=15*r,v=20*r,ka=40*r,Qa=0.6666*ja,j={butter:{name:"Butter",fat:1,dairy:1,health:40,hunger:25,perish:ka,stack:40},butterflywings:{name:"Butterfly Wings",isveggie:!0,decoration:2,health:20,hunger:9.375,perish:k,stack:40},deerclopseyeball:{name:"Deerclops Eyeball",uncookable:!0,health:60,hunger:75,sanity:-15},bird_egg:{name:"Egg",egg:1,health:0,hunger:9.375,sanity:0,perish:l,stack:40,rot:"rottenegg"},bird_egg_cooked:{name:"Cooked Egg",egg:1,
precook:1,health:0,hunger:12.5,sanity:0,perish:k,stack:40},rottenegg:{name:"Rotten Egg",uncookable:!0,health:-1,hunger:-10,stack:40},fish:{name:"Fish",ismeat:!0,meat:0.5,fish:1,health:20,hunger:12.5,perish:Z,stack:40},fish_cooked:{name:"Cooked Fish",ismeat:!0,meat:0.5,fish:1,precook:1,health:40,hunger:12.5,perish:k,stack:40},froglegs:{name:"Frog Legs",ismeat:!0,meat:0.5,health:1,hunger:12.5,perish:k,sanity:-10,stack:40},froglegs_cooked:{name:"Cooked Frog Legs",ismeat:!0,meat:0.5,precook:1,health:3,
hunger:12.5,perish:l,sanity:-10,stack:40},flowerhat:{name:"Garland",health:3,hunger:0,sanity:10,perish:k,stack:1,uncookable:!0},hambat:{name:"Ham Bat",health:-8,hunger:25,sanity:-15,perish:l,stack:1,uncookable:!0},honey:{name:"Honey",sweetener:!0,health:3,hunger:9.375,perish:ka,stack:40},honeycomb:{name:"Honeycomb",sweetener:!0},mandrake:{name:"Mandrake",veggie:1,magic:1,health:60,hunger:75,stack:40},mandrake_cooked:{name:"Cooked Mandrake",uncookable:!0,veggie:1,magic:1,precook:1,health:100,hunger:150,
stack:40},monstermeat:{name:"Monster Meat",ismeat:!0,meat:1,monster:!0,health:-20,hunger:18.75,sanity:-15,perish:k,stack:20,dry:"monstermeat_dried",drytime:r},monstermeat_cooked:{name:"Cooked Monster Meat",ismeat:!0,meat:1,monster:!0,precook:1,health:-3,hunger:18.75,sanity:-10,perish:q,stack:20},monstermeat_dried:{name:"Monster Jerky",ismeat:!0,meat:1,monster:!0,dried:1,health:-3,hunger:18.75,sanity:-5,perish:v,stack:20},meat:{name:"Meat",ismeat:!0,meat:1,health:1,hunger:25,sanity:-10,perish:k,stack:20,
dry:"meat_dried",drytime:2*r},meat_cooked:{name:"Cooked Meat",ismeat:!0,meat:1,precook:1,health:3,hunger:25,sanity:0,perish:l,stack:20},meat_dried:{name:"Jerky",ismeat:!0,meat:1,dried:1,health:20,hunger:25,sanity:15,perish:v,stack:20},morsel:{name:"Morsel",ismeat:!0,meat:0.5,health:0,hunger:12.5,sanity:-10,perish:k,stack:40,drytime:r,dry:"smallmeat_dried"},morsel_cooked:{name:"Cooked Morsel",ismeat:!0,meat:0.5,precook:1,health:1,hunger:12.5,sanity:0,perish:l,stack:40},smallmeat_dried:{name:"Small Jerky",
ismeat:!0,meat:0.5,dried:1,health:8,hunger:12.5,sanity:10,perish:v,stack:40},drumstick:{name:"Drumstick",ismeat:!0,ideal:!0,meat:0.5,health:0,hunger:12.5,sanity:-10,perish:k,stack:20,drytime:r,dry:"smallmeat_dried"},drumstick_cooked:{name:"Fried Drumstick",ismeat:!0,meat:0.5,precook:1,health:1,hunger:12.5,perish:l,stack:20},red_mushroom:{name:"Red Mushroom",veggie:0.5,health:-20,hunger:12.5,sanity:0,perish:l,stack:40,comment:"Bug may prevent using in crock pot"},green_mushroom:{name:"Green Mushroom",
veggie:0.5,health:0,hunger:12.5,sanity:-50,perish:l,stack:40,comment:"Bug may prevent using in crock pot"},blue_mushroom:{name:"Blue Mushroom",veggie:0.5,health:20,hunger:12.5,sanity:-15,perish:l,stack:40,comment:"Bug may prevent using in crock pot"},petals:{name:"Petals",uncookable:!0,health:1,hunger:0,sanity:-2.5,perish:k,stack:40},petals_evil:{name:"Evil Petals",uncookable:!0,health:0,hunger:0,sanity:-5,perish:k,stack:40},seeds:{name:"Seeds",uncookable:!0,health:0,hunger:4.6875,perish:ka,stack:40},
seeds_cooked:{name:"Toasted Seeds",uncookable:!0,health:1,hunger:4.6875,perish:l,stack:40},spoiled_food:{name:"Rot",uncookable:!0,health:-1,hunger:-10,stack:40},tallbirdegg:{name:"Tallbird Egg",egg:4,health:3,hunger:25},tallbirdegg_cooked:{name:"Fried Tallbird Egg",egg:4,precook:1,health:0,hunger:37.5,perish:k},trunk_summer:{name:"Koalefant Trunk",uncookable:!0,ismeat:!0,health:30,hunger:37.5,perish:k,stack:20},trunk_summer_cooked:{name:"Koalefant Trunk Steak",uncookable:!0,ismeat:!0,health:40,hunger:75,
perish:q,stack:20},twigs:{name:"Twigs",inedible:1},carrot:{name:"Carrot",isveggie:!0,veggie:1,health:1,hunger:12.5,perish:l,sanity:0,stack:40},carrot_cooked:{name:"Roasted Carrot",isveggie:!0,veggie:1,precook:1,health:3,hunger:12.5,perish:k,sanity:0,stack:40},corn:{name:"Corn",ideal:!0,isveggie:!0,veggie:1,health:3,hunger:25,perish:l,sanity:0,stack:40},corn_cooked:{name:"Popcorn",isveggie:!0,veggie:1,precook:1,health:3,hunger:12.5,perish:q,sanity:0,stack:40},pumpkin:{name:"Pumpkin",isveggie:!0,veggie:1,
health:3,hunger:37.5,perish:l,sanity:0,stack:20},pumpkin_cooked:{name:"Hot Pumpkin",isveggie:!0,veggie:1,precook:1,health:8,hunger:37.5,perish:k,sanity:0,stack:20},eggplant:{name:"Eggplant",isveggie:!0,veggie:1,health:8,hunger:25,perish:l,sanity:0,stack:20},eggplant_cooked:{name:"Braised Eggplant",isveggie:!0,veggie:1,precook:1,health:20,hunger:25,perish:k,sanity:0,stack:20},durian:{name:"Durian",isfruit:!0,monster:1,fruit:1,health:-3,hunger:25,perish:l,sanity:-5,stack:20},durian_cooked:{name:"Extra Smelly Durian",
isfruit:!0,monster:1,fruit:1,precook:1,health:0,hunger:25,perish:k,sanity:-5,stack:20},pomegranate:{name:"Pomegranate",isfruit:!0,fruit:1,health:3,hunger:9.375,perish:k,sanity:0,stack:40},pomegranate_cooked:{name:"Sliced Pomegranate",isfruit:!0,fruit:1,precook:1,health:20,hunger:12.5,perish:Z,sanity:0,stack:40},dragonfruit:{name:"Dragon Fruit",isfruit:!0,fruit:1,health:3,hunger:9.375,perish:k,sanity:0,stack:40},dragonfruit_cooked:{name:"Prepared Dragon Fruit",isfruit:!0,fruit:1,precook:1,health:20,
hunger:12.5,perish:Z,sanity:0,stack:40},berries:{name:"Berries",isfruit:!0,fruit:0.5,health:0,hunger:9.375,perish:k,sanity:0,stack:40},berries_cooked:{name:"Roasted Berries",isfruit:!0,fruit:0.5,precook:1,health:1,hunger:12.5,perish:Z,sanity:0,stack:40}},Ra=function(){return this.op+this.qty},Sa={"=":function(a){return a===this.qty},">":function(a){return a>this.qty},"<":function(a){return a<this.qty},">=":function(a){return a>=this.qty},"<=":function(a){return a<=this.qty}},la={test:function(a){return!!a},
toString:function(){return""}},p=function(a,b){return{op:a,qty:b,test:Sa[a],toString:Ra}},Ta=function(a,b,c){return this.item1.test(a,b,c)||this.item2.test(a,b,c)},Ua=function(){return this.item1+" or "+this.item2},za=function(a,b){return{item1:a,item2:b,test:Ta,toString:Ua,cancel:a.cancel||b.cancel}},Va=function(a,b,c){return!this.item.test(a,b,c)},Wa=function(){return"not "+this.item},m=function(a){return{item:a,test:Va,toString:Wa,cancel:!0}},Xa=function(a,b){return(b[this.name]||0)+(b[this.name+
"_cooked"]||0)},Ya=function(){return"[*"+j[this.name].name+"|"+j[this.name].img+" "+j[this.name].name+"]"+(j[this.name].cook?"[*"+j[this.name].cook.name+"|"+j[this.name].cook.img+"]":"")+(j[this.name].raw?"[*"+j[this.name].raw.name+"|"+j[this.name].raw.img+"]":"")+(this.qty?this.qty:"")},z=function(a,b){return{name:a,qty:b||la,test:Xa,toString:Ya}},Za=function(a,b){return b[this.name]},$a=function(){return"[*"+j[this.name].name+"|"+j[this.name].img+" "+j[this.name].name+"]"+(this.qty?this.qty:"")},
A=function(a,b){return{name:a,qty:b||la,test:Za,toString:$a}},ab=function(a,b,c){return c[this.tag]},bb=function(){return"[tag:"+this.tag+"|"+this.tag+"]"+(this.qty?this.qty:"")},e=function(a,b){return{tag:a,qty:b||la,test:ab,toString:bb}},f={butterflymuffin:{name:"Butter Muffin",test:function(a,b,c){return b.butterflywings&&!c.meat&&c.veggie},requires:"Butterfly Wings, veggie",requirements:[z("butterflywings"),m(e("meat")),e("veggie")],priority:1,weight:1,foodtype:"veggie",health:20,hunger:37.5,
perish:q,sanity:5,cooktime:2},frogglebunwich:{name:"Froggle Bunwich",test:function(a,b,c){return(b.froglegs||b.froglegs_cooked)&&c.veggie},requirements:[z("froglegs"),e("veggie")],priority:1,foodtype:"meat",health:20,hunger:37.5,perish:q,sanity:5,cooktime:2},taffy:{name:"Taffy",test:function(a,b,c){return c.sweetener&&3<=c.sweetener&&!c.meat},requirements:[e("sweetener",p(">=",3),m(e("meat")))],priority:10,foodtype:"veggie",health:-3,hunger:25,perish:q,sanity:15,cooktime:2},pumpkincookie:{name:"Pumpkin Cookie",
test:function(a,b,c){return(b.pumpkin||b.pumpkin_cooked)&&c.sweetener&&2<=c.sweetener},requirements:[z("pumpkin"),e("sweetener",p(">=",2))],priority:10,foodtype:"veggie",health:0,hunger:37.5,perish:l,sanity:15,cooktime:2},stuffedeggplant:{name:"Stuffed Eggplant",test:function(a,b,c){return(b.eggplant||b.eggplant_cooked)&&c.veggie&&1<c.veggie},requirements:[z("eggplant"),e("veggie",p(">",1))],priority:1,foodtype:"veggie",health:3,hunger:37.5,perish:q,sanity:5,cooktime:2},fishsticks:{name:"Fishsticks",
test:function(a,b,c){return c.fish&&b.twigs&&c.inedible&&1>=c.inedible},requirements:[e("fish"),A("twigs"),e("inedible"),e("inedible",p("<=",1))],priority:10,foodtype:"meat",health:40,hunger:37.5,perish:l,sanity:5,cooktime:2},honeynuggets:{name:"Honey Nuggets",test:function(a,b,c){return b.honey&&c.meat&&1.5>=c.meat&&!c.inedible},requirements:[A("honey"),e("meat",p("<=",1.5)),m(e("inedible"))],priority:2,foodtype:"meat",health:20,hunger:37.5,perish:q,sanity:5,cooktime:2},honeyham:{name:"Honey Ham",
test:function(a,b,c){return b.honey&&c.meat&&1.5<c.meat&&!c.inedible},requirements:[A("honey"),e("meat",p(">",1.5)),m(e("inedible"))],priority:2,foodtype:"meat",health:30,hunger:75,perish:q,sanity:5,cooktime:2},dragonpie:{name:"Dragonpie",test:function(a,b,c){return(b.dragonfruit||b.dragonfruit_cooked)&&!c.meat},requirements:[z("dragonfruit"),m(e("meat"))],priority:1,foodtype:"veggie",health:40,hunger:75,perish:q,sanity:5,cooktime:2},kabobs:{name:"Kabobs",test:function(a,b,c){return c.meat&&b.twigs&&
(!c.monster||1>=c.monster)&&c.inedible&&1>=c.inedible},requirements:[e("meat"),A("twigs"),za(m(e("monster")),e("monster",p("<=",1))),e("inedible"),e("inedible",p("<=",1))],priority:5,foodtype:"meat",health:3,hunger:37.5,perish:q,sanity:5,cooktime:2},mandrakesoup:{name:"Mandrake Soup",test:function(a,b){return b.mandrake},requirements:[A("mandrake")],priority:10,foodtype:"veggie",health:100,hunger:150,perish:k,sanity:5,cooktime:3},baconeggs:{name:"Bacon and Eggs",test:function(a,b,c){return c.egg&&
1<c.egg&&c.meat&&1<c.meat&&!c.veggie},requirements:[e("egg",p(">",1)),e("meat",p(">",1)),m(e("veggie"))],priority:10,foodtype:"meat",health:20,hunger:75,perish:v,sanity:5,cooktime:2},meatballs:{name:"Meatballs",test:function(a,b,c){return c.meat&&!c.inedible},requirements:[e("meat"),m(e("inedible"))],priority:-1,foodtype:"meat",health:3,hunger:62.5,perish:l,sanity:5,cooktime:0.75},bonestew:{name:"Meaty Stew",test:function(a,b,c){return c.meat&&3<=c.meat&&!c.inedible},requirements:[e("meat",p(">=",
3)),m(e("inedible"))],priority:0,foodtype:"meat",health:12,hunger:150,perish:l,sanity:5,cooktime:0.75},perogies:{name:"Pierogi",test:function(a,b,c){return c.egg&&c.meat&&c.veggie&&!c.inedible},requirements:[e("egg"),e("meat"),e("veggie"),m(e("inedible"))],priority:5,foodtype:"meat",health:40,hunger:37.5,perish:v,sanity:5,cooktime:1},turkeydinner:{name:"Turkey Dinner",test:function(a,b,c){return b.drumstick&&1<b.drumstick&&c.meat&&1<c.meat&&(c.veggie||c.fruit)},requirements:[A("drumstick",p(">",1)),
e("meat",p(">",1)),za(e("veggie"),e("fruit"))],priority:10,foodtype:"meat",health:20,hunger:75,perish:k,sanity:5,cooktime:3},ratatouille:{name:"Ratatouille",test:function(a,b,c){return!c.meat&&c.veggie&&!c.inedible},requirements:[m(e("meat")),e("veggie"),m(e("inedible"))],priority:0,foodtype:"veggie",health:3,hunger:25,perish:q,sanity:5,cooktime:1},jammypreserves:{name:"Fist Full of Jam",test:function(a,b,c){return c.fruit&&!c.meat&&!c.veggie&&!c.inedible},requirements:[e("fruit"),m(e("meat")),m(e("veggie")),
m(e("inedible"))],priority:0,foodtype:"veggie",health:3,hunger:37.5,perish:q,sanity:5,cooktime:0.5},fruitmedley:{name:"Fruit Medley",test:function(a,b,c){return c.fruit&&3<=c.fruit&&!c.meat&&!c.veggie},requirements:[e("fruit",p(">=",3)),m(e("meat")),m(e("veggie"))],priority:0,foodtype:"veggie",health:20,hunger:25,perish:k,sanity:5,cooktime:0.5},fishtacos:{name:"Fish Tacos",test:function(a,b,c){return c.fish&&(b.corn||b.corn_cooked)},requirements:[e("fish"),z("corn")],priority:10,foodtype:"meat",health:20,
hunger:37.5,perish:k,sanity:5,cooktime:0.5},waffles:{name:"Waffles",test:function(a,b,c){return b.butter&&(b.berries||b.berries_cooked)&&c.egg},requirements:[A("butter"),z("berries"),e("egg")],priority:10,foodtype:"veggie",health:60,hunger:37.5,perish:k,sanity:5,cooktime:0.5},monsterlasagna:{name:"Monster Lasagna",test:function(a,b,c){return c.monster&&2<=c.monster&&!c.inedible},requirements:[e("monster",p(">=",2)),m(e("inedible"))],priority:10,foodtype:"meat",health:-20,hunger:37.5,perish:k,sanity:-20,
cooktime:0.5},wetgoop:{name:"Wet Goop",test:function(){return!0},requirements:[],trash:!0,priority:-2,health:0,hunger:0,perish:k,sanity:0,cooktime:0.25}},G,n,Aa,cb=/^tag[: ]/,db=/^tag:? */,x,eb=/^recipe[: ]/,fb=/^recipe:? */,ma,gb=/^ingredient[: ]/,hb=/^ingredient:? */,Ba,Ca,ib=function(a){a.match=a.uncookable?0:0===a.lowerName.indexOf(n)||a.raw&&0===a.raw.lowerName.indexOf(n)?3:0===Ca.test(a.lowerName)?2:Ba.test(a.lowerName)?1:0;return a.match},jb=function(a){return a.match=a[Aa]+0||0},kb=function(a){for(var b=
0,c,s=!0;b<x.length;){c=x[b].test(null,a.nameObject,a);if(x[b].cancel){if(!c){s=!0;break}}else c&&(s=!1);b++}return a.match=s?0:1},lb=function(a){for(var b=0,c,s=!0;b<a.requirements.length;){c=a.requirements[b].test(null,ma.nameObject,ma);if(a.requirements[b].cancel){if(!c){s=!0;break}}else c&&(s=!1);b++}return a.match=s?0:1},mb=function(a){return a.match=a.lowerName===n?1:0},nb=function(a){return a.match=a.lowerName===n||a.raw&&a.raw.lowerName===n||a.cook&&a.cook.lowerName===n?1:0},D=function(a,
b){var c,s;return a.match===b.match?(c=a.raw?a.raw.name:a.name,s=b.raw?b.raw.name:b.name,c!==s?c>s?1:c<s?-1:0:a.name===b.name?0:a.raw===b?1:-1):b.match-a.match};G=function(a,b){n=b.toLowerCase();if(cb.test(n))return Aa=n.split(db)[1],a.filter(jb).sort(D);if(eb.test(n))return(x=f.byName(n.split(fb)[1].toLowerCase()))?(x=x.requirements,a.filter(kb).sort(D)):[];if(gb.test(n))return(ma=j.byName(n.split(hb)[1].toLowerCase()))?a.filter(lb).sort(D):[];if(0===n.indexOf("*"))return n=n.substring(1),a.filter(mb).sort(D);
if(0===n.indexOf("~"))return n=n.substring(1),a.filter(nb).sort(D);Ca=RegExp("\\b"+n+".*");Ba=RegExp("\\b"+n.split("").join(".*")+".*");return a.filter(ib).sort(D)};var na=function(a,b,c){var s,d,e;for(s=0;s<a.length;s++)if(e=a[s],null!==e)for(d in b[e.id]=1+(b[e.id]||0),e)e.hasOwnProperty(d)&&"perish"!==d?c[d]=e[d]+(c[d]||0):"perish"===d&&(c[d]=Math.min(c[d]||v,e[d]))},oa,pa,S;oa=function(a,b,c,s){var d,e;a.length=0;pa={};S={};na(b,pa,S);for(b=0;b<f.length;b++){e=!1;for(d=0;d<f[b].requirements.length;d++)if(f[b].requirements[d].test(null,
pa,S))f[b].requirements[d].cancel||(e=!0);else if(!s&&f[b].requirements[d].cancel){e=!1;break}else if(s&&!f[b].requirements[d].cancel){e=!1;break}e&&(!c||-1===c.indexOf(f[b]))&&a.push(f[b])}S.img="";S.name="Combined";return a};var Da,T=[],qa,E;Da=function(a){T.length=0;qa={};E={};na(a,qa,E);for(a=0;a<f.length;a++)f[a].test(null,qa,E)&&T.push(f[a]);T.sort(function(a,c){return c.priority-a.priority});E.img="";E.name="Combined";T.unshift(E);return T};var O=document.createElement("canvas"),ra=O.getContext&&
O.toDataURL&&O.getContext("2d"),U=document.createElement("canvas"),Ea=U.getContext&&U.getContext("2d"),P={},sa={},Fa=!!ra,$=[],ob=function(a){return function(b){b=b.target;ra.clearRect(0,0,64,64);ra.drawImage(b,0,0,64,64);Ea.clearRect(0,0,32,32);Ea.drawImage(b,0,0,32,32);try{P[a]=O.toDataURL(),sa[a]=U.toDataURL()}catch(c){Fa=!1}$.filter(function(b){return b.url===a}).forEach(function(b){b.url===a&&(delete b.img.dataset.pending,aa&&b.img.removeAttribute("data-pending"),b.img.src=32===b.d?sa[a]||a:
P[a]||a)});$=$.filter(function(b){return b.url!==a})}},Ga=function(a,b,c){a.dataset.pending=b;aa&&a.setAttribute("data-pending",b);$.push({url:b,img:a,d:c})},I=function(a,b){var c=new Image,d;Fa?P[a]?c.src=32===b?sa[a]:P[a]:(null!==P[a]&&(P[a]=null,d=new Image,d.addEventListener("load",ob(a),!1),d.src=a),Ga(c,a,b)):c.src=a;return c};O.width=64;O.height=64;U.width=32;U.height=32;I.queue=Ga;var ba,pb=/\[([^\|]*)\|([^\|]*)\]/;ba=function(a){var b=a&&a.split(pb),c,d;if(!b||1===b.length)return a;a=document.createDocumentFragment();
a.appendChild(document.createTextNode(b[0]));for(c=1;c<b.length;c+=3)""===b[c]&&""===b[c+1]?a.appendChild(document.createElement("br")):(d=document.createElement("span"),d.className="link",d.dataset.link=b[c],aa&&d.setAttribute("data-link",b[c]),b[c+1]&&0===b[c+1].indexOf("img/")?(d.appendChild(document.createTextNode(b[c+1].split(" ").slice(1).join(" "))),d.appendChild(I(b[c+1].split(" ")[0],32))):d.appendChild(document.createTextNode(b[c+1]?b[c+1]:b[c])),a.appendChild(d)),a.appendChild(document.createTextNode(b[c+
2]));return a};var g,V=0,ca=document.getElementById("main"),qb=document.getElementById("food"),rb=document.getElementById("recipes"),sb=document.getElementById("navbar"),aa=!1;document.documentElement.dataset||(aa=!0,Object.defineProperty(Element.prototype,"dataset",{get:function(){this.ds||(this.ds={},Array.prototype.forEach.call(this.attributes,function(a){0===a.name.indexOf("data-")&&(this.ds[a.name.substring(5)]=a.value)},this));return this.ds}}));document.getElementById("spoiledsanity").appendChild(document.createTextNode(10));
var h,u=function(a,b){return"[tag:"+a+"|"+(b||a)+"]"};for(g in j)if(j.hasOwnProperty(g)){var d=j[g];d.match=0;d.lowerName=d.name.toLowerCase();d.id=g;d.nameObject={};d.nameObject[g]=1;d.img="img/"+d.name.replace(/ /g,"_").toLowerCase()+".png";-1!==g.indexOf("_cooked")&&(d.cooked=!0);j[g+"_cooked"]&&(d.cook=j[g+"_cooked"],j[g+"_cooked"].raw=d);d.info=[];h=d.info;d.fruit&&h.push(u("fruit")+(1===d.fruit?"":"\u00d7"+d.fruit));d.veggie&&h.push(u("veggie","vegetable")+(1===d.veggie?"":"\u00d7"+d.veggie));
d.meat&&h.push(u("meat")+(1===d.meat?"":"\u00d7"+d.meat));d.egg&&h.push(u("egg")+(1===d.egg?"":"\u00d7"+d.egg));d.fish&&h.push(u("fish"));d.magic&&h.push(u("magic"));d.decoration&&h.push(u("decoration"));d.inedible&&h.push(u("inedible"));d.monster&&h.push(u("monster","monster food"));d.sweetener&&h.push(u("sweetener"));d.fat&&h.push(u("fat"));d.dairy&&h.push(u("dairy"));d.comment&&h.push(d.comment);j[V++]=d}j.length=V;V=0;for(g in f)f.hasOwnProperty(g)&&(f[g].match=0,f[g].name=f[g].name||g,f[g].id=
g,f[g].lowerName=f[g].name.toLowerCase(),f[g].weight=f[g].weight||1,f[g].priority=f[g].priority||0,f[g].img="img/"+f[g].name.replace(/ /g,"_").toLowerCase()+".png",f[g].requirements&&(f[g].requires=ba(f[g].requirements.join("; "))),f[V++]=f[g]);f.length=V;f.forEach=Array.prototype.forEach;f.filter=Array.prototype.filter;f.sort=Array.prototype.sort;f.byName=function(a){for(var b=this.length;b--;)if(this[b].lowerName===a)return this[b]};var tb=function(a,b){return a+"[recipe:"+b.name+"|"+b.img+"]"};
for(g in j)j.hasOwnProperty(g)&&(isNaN(g)&&isNaN(j[g]))&&(d=j[g],h=d.info,d.cooked&&h.push("from [*"+d.raw.name+"|"+d.raw.img+"]"),d.cook&&h.push("cook: [*"+d.cook.name+"|"+d.cook.img+"]"),d.dry&&(d.dry instanceof Object||(d.dry=j[d.dry]),h.push("dry: [*"+d.dry.name+"|"+d.dry.img+"]")),d.info=h.join("; "),d.uncookable?d.info+="[|]cannot be added to crock pot":(d.recipes=[],f.forEach(function(a){for(var b=!1,c=a.requirements,e=c.length;e--;)if(c[e].test(null,d.nameObject,d))!c[e].cancel&&!b&&(b=!0);
else if(c[e].cancel){b=!1;break}b&&d.recipes.push(a)}),0<d.recipes.length&&(d.ingredient=!0,d.info+=d.recipes.reduce(tb,"[|][ingredient:"+d.name+"|Recipes] "))),d.info=ba(d.info));j.forEach=Array.prototype.forEach;j.filter=Array.prototype.filter;j.sort=Array.prototype.forEach;j.byName=function(a){for(var b=this.length;b--;)if(this[b].lowerName===a)return this[b]};var da="id health hunger fruit veggie meat egg fish magic decoration inedible monster sweetener fat dairy".split(" ");Y=K=void 0;j.filter(function(a){return!a.uncookable&&
!a.skip&&(a.ideal||!a.cook&&(!a.raw||!a.raw.ideal))}).map(function(a){for(var b={},c=da.length;c--;)a.hasOwnProperty(da[c])&&(b[da[c]]=a[da[c]]);return b});K=f.filter(function(a){return!a.trash}).sort(function(a,b){return b.priority-a.priority});Y=K.map(function(a){return a.test});K.map(function(a){return a.test.toString()});K.map(function(a){return a.priority});var ea,Ha=sb.getElementsByTagName("li"),W={},X={},B,Q,J,ub=function(a){ea(a.target.dataset.tab)},y;ea=function(a){J.className="";J=W[a];
Q.style.display="none";Q=X[a];J.className="selected";Q.style.display="block"};for(g=0;g<Ha.length;g++)y=Ha[g],y.dataset.tab&&(W[y.dataset.tab]=y,X[y.dataset.tab]=document.getElementById(y.dataset.tab),X[y.dataset.tab].style.display="none",y.addEventListener("click",ub,!1));J=W.simulator;Q=X.simulator;window.localStorage&&localStorage.foodGuideState&&("["===localStorage.foodGuideState[0]?(B={},B.pickers=JSON.parse(localStorage.foodGuideState),localStorage.foodGuideState=JSON.stringify(B)):B=JSON.parse(localStorage.foodGuideState),
B.activeTab&&W[B.activeTab]&&(J=W[B.activeTab],Q=X[B.activeTab]));J.className="selected";Q.style.display="block";window.addEventListener("beforeunload",function(){var a;window.localStorage&&(localStorage.foodGuideState||(localStorage.foodGuideState="{}"),a=JSON.parse(localStorage.foodGuideState),a.activeTab=J.dataset.tab,localStorage.foodGuideState=JSON.stringify(a))});var vb=function(a){a.dataset.pending&&I.queue(a,a.dataset.pending,32)},ta=function(a){var b,c,d,e=document.createElement("tr"),f;
for(b=1;b<arguments.length;b++)c=document.createElement(a),f=(d=arguments[b])&&d.indexOf?d:d.toString(),d instanceof DocumentFragment?(c.appendChild(d.cloneNode(!0)),Array.prototype.forEach.call(c.getElementsByTagName("img"),vb)):0===f.indexOf("img/")?(d=I(f),c.appendChild(d)):c.appendChild(document.createTextNode(f)),e.appendChild(c);return e},N=function(a,b,c,d,e,f,j,g,k,n){var F,l,t,h=!1,C,m,p,r=function(a){var b;if((!n||p<n)&&(!g||g(a)))b=c(a),j&&j(a)&&(b.className="highlighted",C||(C=b),m=b),
F.appendChild(b),p++},q=function(c,d,j){var s,g;if(d||c&&""!==c.target.dataset.sort||t){s=d||c&&c.target.dataset.sort||t;e&&(g=b.shift());"name"===s?b.sort(function(a,b){var c=a.raw?a.raw.name:a.name,d=b.raw?b.raw.name:b.name;return c!==d?c>d?1:c<d?-1:0:a.name===b.name?0:a.raw===b?1:-1}):b.sort(function(a,b){var c=a[s],d=b[s];return!isNaN(c)&&!isNaN(d)?d-c:isNaN(c)&&isNaN(d)?0:isNaN(c)?1:-1});if(d||c)t===s?h=!h:(t=s,h=!1);h&&b.reverse();e&&b.unshift(g)}c=document.createElement("tr");for(l in a)d=
document.createElement("th"),d.appendChild(document.createTextNode(l)),a[l]&&(a[l]===t&&(d.style.background=h?"#555":"#ccc",d.style.color=h?"#ccc":"#555",d.style.borderRadius="4px"),d.style.cursor="pointer",d.dataset.sort=a[l],d.addEventListener("click",q,!1)),c.appendChild(d);d=F;F=document.createElement("table");F.appendChild(c);m=C=null;p=0;b.forEach(r);f&&(F.className="links",Array.prototype.forEach.call(F.getElementsByClassName("link"),function(a){a.addEventListener("click",f,!1)}));d&&d.parentNode.replaceChild(F,
d);j&&(C&&C.offsetTop+F.offsetTop+ca.offsetTop+C.offsetHeight>window.scrollY+window.innerHeight?C.scrollIntoView(!0):m&&m.offsetTop+F.offsetTop+ca.offsetTop<window.scrollY&&m.scrollIntoView(!1))};d?q(null,d):q();F.update=function(a){q(null,null,a)};F.setMaxRows=function(a){n=a;this.update()};return F},w=function(a){return isNaN(a)?"":0<a?"+"+a:a},Ia=function(a,b){return a<b?(b-a)/Math.abs(a):a>b?-(a-b)/Math.abs(a):0},Ja=function(a,b){return!isNaN(a)&&a!==b?" ("+w((100*(a<b?(b-a)/Math.abs(a):a>b?-(a-
b)/Math.abs(a):0)).toFixed(0))+"%)":""},Ka=function(a){return ta("td",a.img?a.img:"",a.name,w(a.health),w(a.hunger),isNaN(a.sanity)?"":w(a.sanity),isNaN(a.perish)?"Never":a.perish/r+" days",a.info||"")},ga=function(a,b,c){return ta("td",a.img?a.img:"",a.name,w(a.health)+Ja(b,a.health),w(a.hunger)+Ja(c,a.hunger),isNaN(a.sanity)?"":w(a.sanity),isNaN(a.perish)?"Never":a.perish/r+" days",(a.cooktime*Qa+0.5|0)+" secs",a.priority||"0",a.requires||"")},ha,ia=[],La=[],wa=N({"":"",Name:"name",Health:"health",
Hunger:"hunger",Sanity:"sanity",Perish:"perish",Info:""},Array.prototype.slice.call(j),Ka,"name",!1,function(a){a=!a.target?a:"IMG"===a.target.tagName?a.target.parentNode.dataset.link:a.target.dataset.link;"recipe:"===a.substring(0,7)||"ingredient:"===a.substring(0,11)?(ea("crockpot"),"recipe:"===a.substring(0,7)&&(a="*"+a.substring(7)),La=G(f,a),Ma.update(!0)):(ha!==a?(ha=a,ia=G(j,a)):(ha="",ia.length=0),wa.update(!0))},function(a){return-1!==ia.indexOf(a)}),Ma=N({"":"",Name:"name",Health:"health",
Hunger:"hunger",Sanity:"sanity",Perish:"perish","Cook Time":"cooktime",Priority:"priority",Requires:""},Array.prototype.slice.call(f),ga,"name",!1,function(a){a=!a.target?a:"IMG"===a.target.tagName?a.target.parentNode.dataset.link:a.target.dataset.link;ea("foodlist");ha=a;ia=G(j,a);wa.update(!0)},function(a){return-1!==La.indexOf(a)});qb.appendChild(wa);rb.appendChild(Ma);var wb=function(a,b){return a+"[ingredient:"+j[b.id].name+"|"+j[b.id].img+"]"},Oa=function(a){var b=document.createElement("button");
b.appendChild(document.createTextNode("Calculate efficient recipes (may take some time)"));b.className="makablebutton";b.addEventListener("click",function(){var c=[],d=a?a.length:null,e,g,k=[],h,l,n,m,p=[],t=[],q,C,r,u=function(a){return-1!==t.indexOf(a.id)},G=function(a){return-1!==this.indexOf(j[a])},B=function(a){-1!==t.indexOf(a.target.dataset.id)&&t.splice(t.indexOf(a.target.dataset.id),1);-1!==p.indexOf(a.target.dataset.id)?(p.splice(p.indexOf(a.target.dataset.id),1),a.target.className=""):
(p.push(a.target.dataset.id),a.target.className="selected");r.update()},y=function(a){-1!==p.indexOf(a.target.dataset.id)&&p.splice(p.indexOf(a.target.dataset.id),1);-1!==t.indexOf(a.target.dataset.id)?(t.splice(t.indexOf(a.target.dataset.id),1),a.target.className=""):(t.push(a.target.dataset.id),a.target.className="excluded");r.update();a.preventDefault()},H=function(a){g&&(g.className="");e===a.target.dataset.recipe?e=g=null:(e=a.target.dataset.recipe,g=a.target,a.target.className="selected");r.update()};
null===d&&(d=j.length,a=j);for(;d--;)a[d].cook&&(-1===c.indexOf(a[d].cook)&&!a[d].cook.uncookable)&&c.push(a[d].cook),!a[d].uncookable&&((a[d].ideal||!a[d].cook||a[d].cook.uncookable)&&-1===c.indexOf(a[d]))&&c.push(a[d]);q=[];r=N({"":"",Name:"name",Health:"health","Health+":"healthpls",Hunger:"hunger","Hunger+":"hungerpls",Ingredients:""},q,function(a){var b=a.recipe;return ta("td",b.img?b.img:"",b.name,w(b.health),w(a.healthpls)+" ("+w(100*a.healthpct|0)+"%)",w(b.hunger),w(a.hungerpls)+" ("+w(100*
a.hungerpct|0)+"%)",ba(a.ingredients.reduce(wb,"")))},"hungerpls",!1,null,null,function(a){return(!e||a.recipe.name===e)&&(!t.length||!a.ingredients.some(u))&&(!p.length||p.every(G,a.ingredients))},0,15);C=document.createElement("div");l=document.createElement("div");l.appendChild(document.createTextNode("Computing combinations.."));C.appendChild(l);h=document.createElement("div");h.className="recipeFilter";C.appendChild(h);n=document.createElement("div");n.className="foodFilter";c.forEach(function(a){var b=
I(a.img,32);b.dataset.id=a.id;b.addEventListener("click",B,!1);b.addEventListener("contextmenu",y,!1);n.appendChild(b)});C.appendChild(n);d=document.createElement("div");m=document.createElement("input");m.type="text";m.placeholder="use custom filter";m.className="customFilterInput";d.appendChild(m);C.appendChild(r);b.parentNode.replaceChild(C,b);var z=function(){l.firstChild.textContent="Found "+q.length+" valid recipes.."},A=function(){r.setMaxRows(30);l.firstChild.textContent="Found "+q.length+
" valid recipes. Showing top 30 for selected recipe using all selected ingredients. Right-click to exclude ingredients."},J=Y.length,fa=[],L=0,ua,va=3,xb=function(a){return c[a]},Na,xa=c.length,M=[0,0,0,0],v,x=0,D=0;Na=function(a){for(var b;a--&&1<xa&&2E5>D;){b=M;var c=b.map(xb),d=void 0,L=null,e={},f={};na(c,e,f);for(d=0;d<J&&(null===L||K[d].priority>=L);d++)Y[d](null,e,f)&&(fa.push({recipe:K[d],combination:b,ingredients:c,tags:f}),L=K[d].priority);M[0]++;for(b=0;M[b]>=xa;)b++,M[b]++;v=4;for(x=0;v--;)M[v]>=
xa?M[v]=x:M[v]>x&&(x=M[v]);if(4===b)return!1;D++}return!0};var E=function(){var a=!1,b=Date.now();for(Na(va)?setTimeout(E,3):a=!0;L<fa.length&&fa[L];L++){var c=fa[L],d=void 0,e=void 0;if(-1===k.indexOf(c.recipe.name)){for(d=0;d<k.length&&!(c.recipe.name<k[d]);d++);k.splice(d,0,c.recipe.name);e=I(f.byName(k[d].toLowerCase()).img);e.dataset.recipe=k[d];e.addEventListener("click",H,!1);d<h.childNodes.length?h.insertBefore(e,h.childNodes[d]):h.appendChild(e)}c.name||(c.name=c.recipe.name,c.health=c.recipe.health,
c.ihealth=c.tags.health,c.healthpls=c.recipe.health-c.tags.health,c.hunger=c.recipe.hunger,c.ihunger=c.tags.hunger,c.hungerpls=c.recipe.hunger-c.tags.hunger,c.healthpct=Ia(c.tags.health,c.recipe.health),c.hungerpct=Ia(c.tags.hunger,c.recipe.hunger),c.sanity=c.recipe.sanity,c.perish=c.recipe.perish,c.worth=c.tags.worth);q.push(c)}ua!==Date.now()-b&&(ua=Date.now()-b+1,va=38/ua*va+1|0);z&&z();a&&A&&A()};E()},!1);return b};document.getElementById("statistics").appendChild(Oa());window.food=j;window.recipes=
f;window.matchingNames=G;for(var R=function(a,b){var c=!1;null!==b?a.dataset.id=b.id:a.nextSibling&&null!==H(a.nextSibling)?(R(a,H(a.nextSibling)),R(a.nextSibling,null),c=!0):a.dataset.id=null;c||(null!==b?a.firstChild?a.replaceChild(I(b.img),a.firstChild):a.appendChild(I(b.img)):a.firstChild&&a.removeChild(a.firstChild),a.title=b?b.name:"")},H=function(a){return j[a.dataset.id]||f[a.dataset.id]||null},Pa=document.getElementsByClassName("ingredientpicker"),ya=Pa.length;ya--;)(function(){var a=document.createElement("div"),
b=document.createElement("ul"),c=Pa[ya],d=ya,e,g="recipes"===c.dataset.type?f:j,k=c.nextSibling,h=k.getElementsByClassName("ingredient"),l,m,n=[],p=[],t=document.getElementById("results"),q=document.getElementById("discoverfood"),r=document.getElementById("discover"),u=document.getElementById("makable"),v=document.createElement("span"),w=!1,x=function(a){var b=j[a]||f[a]||null;if(l){for(a=0;a<h.length;a++)if(null===H(h[a]))return R(h[a],b),m(),a;return-1}-1===h.indexOf(a)&&(h.push(a),a=document.createElement("span"),
a.className="ingredient",R(a,b),a.addEventListener("click",B,!1),k.appendChild(a),m());return 1},z=function(d){var e,f=x(("IMG"===d.target.tagName?d.target.parentNode:d.target).dataset.id);-1!==f&&(a.removeChild(b),b=document.createElement("ul"),e=G(g,""),e.forEach(A,b),a.appendChild(b),b.firstChild&&(b.firstChild.className="selected"),c.value="",f<h.length-1||!l?c.focus():c.blur(),d&&d.preventDefault&&d.preventDefault(),y())},A=function(a){var b=I(a.img,32),c=document.createElement("li");c.appendChild(b);
c.appendChild(document.createTextNode(a.name));c.dataset.id=a.id;c.addEventListener("mousedown",z,!1);this.appendChild(c)},B=function(a){var b="IMG"===a.target.tagName?a.target.parentNode:a.target;if(l){if(null!==H(b))return R(b,null),m(),b.dataset.id;c.focus()}else return a=h.indexOf(b.dataset.id),h.splice(a,1),k.removeChild(b),m(),h[a]||null},y=function(){0<ca.offsetLeft-a.offsetWidth?(a.style.left=-a.offsetWidth+"px",a.style.top=c.offsetTop+"px"):ca.offsetLeft+c.offsetLeft+c.offsetWidth+a.offsetWidth>
window.innerWidth?(a.style.left=c.offsetLeft+"px",a.style.top=c.offsetTop+c.offsetHeight+"px"):(a.style.left=c.offsetLeft+c.offsetWidth+"px",a.style.top=c.offsetTop+"px")},D=function(){document.createElement("li");var d=G(g,c.value);a.removeChild(b);b=document.createElement("ul");d.forEach(A,b);b.firstChild&&(b.firstChild.className="selected");a.appendChild(b);y()},E=function(a){a="IMG"===a.target.tagName?a.target.parentNode.dataset.link:a.target.dataset.link;var b=G(g,a);1===b.length?x(b[0].id):
(c.value=a,D(),c.focus())};"ingredients"===k.id?m=function(){var a,b,c,d,e;a=Array.prototype.map.call(h,function(a){return H(a)});b=Da(a);c=b[0].health;d=b[0].hunger;e=N({"":"",Name:"name",Health:"health",Hunger:"hunger",Sanity:"sanity",Perish:"perish","Cook Time":"cooktime",Priority:"priority",Requires:""},b,function(a){return ga(a,c,d)},"priority",!0,E);t.firstChild&&t.removeChild(t.firstChild);t.firstChild&&(t.removeChild(t.firstChild),t.removeChild(t.firstChild));t.appendChild(e);null!==a[0]&&
(oa(n,a,b),0<n.length&&(t.appendChild(document.createTextNode("Add more ingredients to make:")),e=N({"":"",Name:"name",Health:"health",Hunger:"hunger",Sanity:"sanity",Perish:"perish","Cook Time":"cooktime",Priority:"priority",Requires:""},n,function(a){return ga(a,c,d)},"priority",!1,E),t.appendChild(e)))}:"inventory"===k.id&&(m=function(){var a,b;a=Array.prototype.map.call(k.getElementsByClassName("ingredient"),function(a){return H(a)});q.firstChild&&q.removeChild(q.firstChild);r.firstChild&&r.removeChild(r.firstChild);
u.firstChild&&u.removeChild(u.firstChild);0<a.length&&(b=N({"":"",Name:"name",Health:"health",Hunger:"hunger",Sanity:"sanity",Perish:"perish",Info:""},a,Ka,"name"),q.appendChild(b),oa(p,a,null,!0),0<p.length&&(b=N({"":"",Name:"name",Health:"health",Hunger:"hunger",Sanity:"sanity",Perish:"perish","Cook Time":"cooktime",Priority:"priority",Requires:""},p,ga,"name"),r.appendChild(b),u.appendChild(Oa(a))))});0!==h.length?(l=!0,Array.prototype.forEach.call(h,function(a){R(a,null);a.addEventListener("click",
B,!1)})):(h=[],l=!1);window.localStorage&&localStorage.foodGuideState&&(e=JSON.parse(localStorage.foodGuideState).pickers)&&e[d]&&e[d].forEach(function(a){j[a]&&x(a)});a.className="ingredientdropdown";a.appendChild(b);a.addEventListener("mousedown",function(a){a.preventDefault()},!1);document.createElement("li");e=G(g,c.value);a.removeChild(b);b=document.createElement("ul");e.forEach(A,b);a.appendChild(b);b.firstChild&&(b.firstChild.className="selected");v.className="clearingredients";v.appendChild(document.createTextNode("clear"));
v.addEventListener("click",function(){if(""===c.value)for(;H(k.firstChild);)B({target:k.firstChild});else c.value="",D()},!1);k.parentNode.insertBefore(v,k);c.addEventListener("keydown",function(){},!1);c.addEventListener("keyup",function(a){var c,d,e;if(-1===[16,17,37,38,39,40,13].indexOf(a.keyCode))D();else{d=b.getElementsByTagName("li");for(e=0;e<d.length;e++)if("selected"===d[e].className){c=d[e];if(38===a.keyCode||40===a.keyCode)d[e].className="";38===a.keyCode?d[0>e-1?d.length-1:e-1].className=
"selected":40===a.keyCode?d[(e+1)%d.length].className="selected":13===a.keyCode&&c&&(z({target:c}),y());break}!c&&0<d.length&&(38===a.keyCode?d[d.length-1].className="selected":40===a.keyCode?d[0].className="selected":13===a.keyCode&&z({target:d[0]}))}},!1);c.addEventListener("focus",function(){w||(w=!0,k.appendChild(a),y())},!1);c.addEventListener("blur",function(){w&&(w=!1,k.removeChild(a))},!1);m();window.addEventListener("beforeunload",function(){var a,b;window.localStorage&&(localStorage.foodGuideState||
(localStorage.foodGuideState="{}"),a=JSON.parse(localStorage.foodGuideState),a.pickers||(a.pickers=[]),l?(b=[],b=Array.prototype.map.call(h,function(a){return(a=H(a))?a.id:null}),a.pickers[d]=b):a.pickers[d]=h,localStorage.foodGuideState=JSON.stringify(a))})})()})();